

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>birdepy.estimate() &mdash; BirDePy 0.0.7 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/Birdepy_favicon_3.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="birdepy.simulate.discrete()" href="api_simulate_discrete.html" />
    <link rel="prev" title="birdepy.probability()" href="api_probability.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/Birdepy_logo_1_resized.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Theoretical Background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="processes.html">Birth-and-death Processes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="processes.html#custom-models">Custom Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="probabilities.html">Transition Probabilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#matrix-exponential">Matrix exponential</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#uniformization">Uniformization</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#erlangization">Erlangization</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#inverse-laplace-transform">Inverse Laplace transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#diffusion-approximation">Diffusion approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#ornstein-uhlenbeck-approximation">Ornstein–Uhlenbeck approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#galton-watson-approximation">Galton–Watson approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#saddle-point-approximation">Saddle-point approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="probabilities.html#simulation">Simulation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="estimation.html">Parameter Estimation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#direct-numerical-maximization">Direct Numerical Maximization</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#expectation-maximization">Expectation Maximization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="estimation.html#expectation-step-techniques">Expectation Step Techniques</a></li>
<li class="toctree-l3"><a class="reference internal" href="estimation.html#acceleration">Acceleration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#least-squares-estimation">Least Squares Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#approximate-bayesian-computation">Approximate Bayesian Computation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="estimation.html#customized-distance">Customized Distance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#known-parameters">Known Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#parameter-constraints">Parameter Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#confidence-regions">Confidence Regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#continuously-observed-data">Continuously Observed Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimation.html#optimization-options">Optimization Options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="simulation.html">Simulation Algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="simulation.html#reproducibility">Reproducibility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="forecasting.html">Forecasting</a></li>
</ul>
<p class="caption"><span class="caption-text">Core Functions API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api_probability.html">birdepy.probability()</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-da">birdepy.probability(method=’da’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-erlang">birdepy.probability(method=’Erlang’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-expm">birdepy.probability(method=’expm’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-gwa">birdepy.probability(method=’gwa’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-gwasa">birdepy.probability(method=’gwasa’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-ilt">birdepy.probability(method=’ilt’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-oua">birdepy.probability(method=’oua’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-sim">birdepy.probability(method=’sim’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_probability.html#birdepy-probability-method-uniform">birdepy.probability(method=’uniform’)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">birdepy.estimate()</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#birdepy-estimate-framework-abc">birdepy.estimate(framework=’abc’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#birdepy-estimate-framework-dnm">birdepy.estimate(framework=’dnm’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#birdepy-estimate-framework-em">birdepy.estimate(framework=’em’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#birdepy-estimate-framework-lse">birdepy.estimate(framework=’lse’)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#birdepy-estimate-scheme-continuous">birdepy.estimate(scheme=’continuous’)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_simulate_discrete.html">birdepy.simulate.discrete()</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_simulate_continuous.html">birdepy.simulate.continuous()</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_forecast.html">birdepy.forecast()</a></li>
</ul>
<p class="caption"><span class="caption-text">CUDA Functions API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api_cuda_simulate.html">birdepy.gpu_functions.discrete()</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_cuda_probabilities.html">birdepy.gpu_functions.probability()</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Bug Reports and Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id1">0.0.7</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id2">0.0.6</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id3">0.0.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id4">0.0.4</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id5">0.0.3</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id6">0.0.2</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_notes.html#id7">0.0.1</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BirDePy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>birdepy.estimate()</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/api_estimate.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="birdepy-estimate">
<h1>birdepy.estimate()<a class="headerlink" href="#birdepy-estimate" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="birdepy.estimate">
<span class="sig-prename descclassname"><span class="pre">birdepy.</span></span><span class="sig-name descname"><span class="pre">estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framework</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dnm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Verhulst'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'discrete'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_known_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asymptotic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#birdepy.estimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter estimation for (continuously or discretely observed)
continuous-time birth-and-death processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_data</strong> (<em>array_like</em>) – Observation times of birth-and-death process. If one trajectory is
observed, then this is a list. If multiple trajectories are observed,
then this is a list of lists where each list corresponds to a
trajectory.</p></li>
<li><p><strong>p_data</strong> (<em>array_like</em>) – Observed populations of birth-and-death process at times in argument
<cite>t_data</cite>. If one trajectory is observed, then this is a list. If
multiple trajectories are observed, then this is a list of lists
where each list corresponds to a trajectory.</p></li>
<li><p><strong>p0</strong> (<em>array_like</em>) – Initial parameter guess. Array of real elements of size (n,), where n
is the number of unknown parameters.</p></li>
<li><p><strong>p_bounds</strong> (<em>list</em>) – Bounds on parameters. Should be specified as a sequence of
<code class="docutils literal notranslate"><span class="pre">(min,</span> <span class="pre">max)</span></code> pairs for each unknown parameter. See <a class="reference internal" href="estimation.html#parameter-constraints"><span class="std std-ref">here</span></a>.</p></li>
<li><p><strong>framework</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Parameter estimation framework. Should be one of:</p>
<blockquote>
<div><ul>
<li><p>’abc’ (see <a class="reference internal" href="#birdepy-estimate-framework-abc"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’dnm’ (default) (see <a class="reference internal" href="#birdepy-estimate-framework-dnm"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’em’ (see <a class="reference internal" href="#birdepy-estimate-framework-em"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’lse’ (see <a class="reference internal" href="#birdepy-estimate-framework-lse"><span class="std std-ref">here</span></a>)</p></li>
</ul>
</div></blockquote>
<p>Additional kwargs are available for each framework.</p>
</p></li>
<li><p><strong>model</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Model specifying birth and death rates of process (see <a class="reference internal" href="processes.html#birth-and-death-processes"><span class="std std-ref">here</span></a>). Should be one of:</p>
<blockquote>
<div><blockquote>
<div><ul>
<li><p>’Verhulst’ (default)</p></li>
<li><p>’Ricker’</p></li>
<li><p>’Hassell’</p></li>
<li><p>’MS-S’</p></li>
<li><p>’Moran’</p></li>
<li><p>’pure-birth’</p></li>
<li><p>’pure-death’</p></li>
<li><p>’Poisson’</p></li>
<li><p>’linear’</p></li>
<li><p>’linear-migration’</p></li>
<li><p>’M/M/1’</p></li>
<li><p>’M/M/inf’</p></li>
<li><p>’loss-system’</p></li>
<li><p>’custom’</p></li>
</ul>
</div></blockquote>
<p>If set to ‘custom’, then kwargs <cite>b_rate</cite> and <cite>d_rate</cite> must also be
specified. See <a class="reference internal" href="processes.html#custom-models"><span class="std std-ref">here</span></a> for more information.</p>
</div></blockquote>
</p></li>
<li><p><strong>scheme</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Observation scheme. Should be one of:</p>
<blockquote>
<div><ul>
<li><p>’discrete’ (default)</p></li>
<li><p>’continuous’ (see <a class="reference internal" href="#birdepy-estimate-scheme-continuous"><span class="std std-ref">here</span></a>)</p></li>
</ul>
</div></blockquote>
<p>If set to ‘continuous’, then it is assumed that the population is
observed continuously with jumps occuring at times in <cite>t_data</cite> into
corresponding states in <cite>p_data</cite>.</p>
</p></li>
<li><p><strong>con</strong> (<em>{Constraint</em><em>, </em><em>dict}</em><em> or </em><em>List of {Constraint</em><em>, </em><em>dict}</em><em>, </em><em>optional</em>) – Constraints definition for parameters (only for kwarg <cite>opt_method</cite>
equal to ‘differential-evolution’, ‘COBYLA’, ‘SLSQP’ or
‘trust-constr’).   See <a class="reference internal" href="estimation.html#parameter-constraints"><span class="std std-ref">here</span></a> for more
information.</p></li>
<li><p><strong>known_p</strong> (<em>array_like</em><em>, </em><em>optional</em>) – List of known parameter values. For built in models these must be in
their canonical order as given (<a class="reference internal" href="processes.html#birth-and-death-processes"><span class="std std-ref">here</span></a>). If this
argument is given, then argument <cite>idx_known_p</cite> must also be specified.
See <a class="reference internal" href="estimation.html#known-parameters"><span class="std std-ref">here</span></a> for more information.</p></li>
<li><p><strong>idx_known_p</strong> (<em>array_like</em><em>, </em><em>optional</em>) – List of indices of known parameters (as given in argument ‘known_p’).
For built in models indices must correspond to canonical order as given
<a class="reference internal" href="processes.html#birth-and-death-processes"><span class="std std-ref">here</span></a>. If this argument is given, then argument
<cite>known_p</cite> must also be specified. See <a class="reference internal" href="estimation.html#known-parameters"><span class="std std-ref">here</span></a>
for more information.</p></li>
<li><p><strong>se_type</strong> (<em>string</em><em>, </em><em>optional</em>) – Should be one of: ‘none’ (default), ‘simulated’, or ‘asymptotic’.
See <a class="reference internal" href="estimation.html#confidence-regions"><span class="std std-ref">here</span></a> for more information.</p></li>
<li><p><strong>display</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then progress updates are provided for some methods.</p></li>
<li><p><strong>ci_plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Enables confidence region plotting for 2d parameter estimates.</p></li>
<li><p><strong>export</strong> (<em>str</em><em>, </em><em>optional</em>) – File name for export of confidence region figure to a LaTeX file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong> – The estimation output represented as an <code class="xref py py-func docutils literal notranslate"><span class="pre">EstimationOutput()</span></code>
object. Important attributes are: <cite>p</cite> the parameter estimate, <cite>se</cite> the
standard error estimate, <cite>cov</cite> the estimated covariance of the
assumed distribution of the parameter estimate, <cite>val</cite> is the log-likelihood
for ‘framework’ <cite>dnm’ and ‘em’, squared error for ‘framework’ `lse’,
`capacity</cite> is the estimated carrying capacity.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>EstimationOutput</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Example 1: Simulate a discretely observed sample path and estimate the parameters using the
alternative frameworks.
First simulate some sample paths of a Verhulst 2 (SIS) model using
<a class="reference internal" href="api_simulate_discrete.html#birdepy.simulate.discrete" title="birdepy.simulate.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.discrete()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">birdepy</span> <span class="k">as</span> <span class="nn">bd</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">p_data</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">simulate</span><span class="o">.</span><span class="n">discrete</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">t_data</span><span class="p">,</span>
                              <span class="n">survival</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, using the simulated data, estimate the parameters using ‘dnm’, ‘lse’
and ‘em’ as the argument of <cite>framework</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">est_dnm</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
                      <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;dnm&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">est_em</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span><span class="mf">0.1</span><span class="p">]],</span>
                      <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">est_abc</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
                      <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">est_lse</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
                      <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;lse&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">se_type</span><span class="o">=</span><span class="s1">&#39;simulated&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;abc estimate:&#39;</span><span class="p">,</span> <span class="n">est_abc</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;, abc standard errors:&#39;</span><span class="p">,</span> <span class="n">est_abc</span><span class="o">.</span><span class="n">se</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dnm estimate:&#39;</span><span class="p">,</span> <span class="n">est_dnm</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;, dnm standard errors:&#39;</span><span class="p">,</span> <span class="n">est_dnm</span><span class="o">.</span><span class="n">se</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lse estimate:&#39;</span><span class="p">,</span> <span class="n">est_lse</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;, lse standard errors:&#39;</span><span class="p">,</span> <span class="n">est_lse</span><span class="o">.</span><span class="n">se</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;em estimate:&#39;</span><span class="p">,</span> <span class="n">est_em</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;, em standard errors:&#39;</span><span class="p">,</span> <span class="n">est_em</span><span class="o">.</span><span class="n">se</span><span class="p">)</span>
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">abc</span> <span class="n">estimate</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5237212840549004</span><span class="p">,</span> <span class="mf">0.15633742500248485</span><span class="p">,</span> <span class="mf">0.04781193037194212</span><span class="p">]</span> <span class="p">,</span> <span class="n">abc</span> <span class="n">standard</span> <span class="n">errors</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.26827164</span> <span class="mf">0.13484149</span> <span class="mf">0.02876892</span><span class="p">]</span>
<span class="n">dnm</span> <span class="n">estimate</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7477212189824904</span><span class="p">,</span> <span class="mf">0.2150484536334751</span><span class="p">,</span> <span class="mf">0.022745124483227304</span><span class="p">]</span> <span class="p">,</span> <span class="n">dnm</span> <span class="n">standard</span> <span class="n">errors</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.16904225</span> <span class="mf">0.03443199</span> <span class="mf">0.00433567</span><span class="p">]</span>
<span class="n">em</span> <span class="n">estimate</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7375802511179848</span><span class="p">,</span> <span class="mf">0.19413965548145604</span><span class="p">,</span> <span class="mf">0.024402343633644553</span><span class="p">]</span> <span class="p">,</span> <span class="n">em</span> <span class="n">standard</span> <span class="n">errors</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.15742852</span> <span class="mf">0.02917437</span> <span class="mf">0.00429763</span><span class="p">]</span>
<span class="n">lse</span> <span class="n">estimate</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.7941741586214265</span><span class="p">,</span> <span class="mf">0.2767698457541133</span><span class="p">,</span> <span class="mf">0.01935636627568731</span><span class="p">]</span> <span class="p">,</span> <span class="n">lse</span> <span class="n">standard</span> <span class="n">errors</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1568291</span>  <span class="mf">0.19470746</span> <span class="mf">0.01243208</span><span class="p">]</span>
</pre></div>
</div>
<p>Alternatively, we may be interested in continuously observed data.</p>
<p>Example 2: Simulate a continuous sample path and estimate the parameters.</p>
<p>Simulate some synthetic data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">simulate</span><span class="o">.</span><span class="n">continuous</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
                                        <span class="mi">100</span><span class="p">,</span> <span class="n">survival</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
</pre></div>
</div>
<p>Estimate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
                  <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;continuous&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">0.7603171062895576</span><span class="p">,</span> <span class="mf">0.2514810854871476</span><span class="p">,</span> <span class="mf">0.020294342655751033</span><span class="p">]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Estimation algorithms and models are also described in [1]. If you use this
function for published work, then please cite this paper.</p>
<p>For a text book treatment on the theory of birth-and-death processes
see [2].</p>
<p>If <cite>model</cite> is ‘Poisson’, then the true dnm is immediately returned (i.e.,
the total number of events during the observation periods divided by the
total observation time).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> <a class="reference internal" href="api_probability.html#birdepy.probability" title="birdepy.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.probability()</span></code></a> <a class="reference internal" href="api_forecast.html#birdepy.forecast" title="birdepy.forecast"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.forecast()</span></code></a></p>
<p><a class="reference internal" href="api_simulate_discrete.html#birdepy.simulate.discrete" title="birdepy.simulate.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.discrete()</span></code></a> <a class="reference internal" href="api_simulate_continuous.html#birdepy.simulate.continuous" title="birdepy.simulate.continuous"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.continuous()</span></code></a></p>
<p><a class="reference internal" href="api_cuda_probabilities.html#birdepy.gpu_functions.probability" title="birdepy.gpu_functions.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.gpu_functions.probability()</span></code></a>  <a class="reference internal" href="api_cuda_simulate.html#birdepy.gpu_functions.discrete" title="birdepy.gpu_functions.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.gpu_functions.discrete()</span></code></a></p>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id1"><span class="brackets">1</span></dt>
<dd><p>Hautphenne, S. and Patch, B. BirDePy: Parameter estimation for
population-size-dependent birth-and-death processes in Python. ArXiV, 2021.</p>
</dd>
<dt class="label" id="id2"><span class="brackets">2</span></dt>
<dd><p>Feller, W. (1968) An introduction to probability theory and its
applications (Volume 1) 3rd ed. John Wiley &amp; Sons.</p>
</dd>
</dl>
</dd></dl>

<div class="section" id="birdepy-estimate-framework-abc">
<h2>birdepy.estimate(framework=’abc’)<a class="headerlink" href="#birdepy-estimate-framework-abc" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="birdepy.interface_abc.discrete_est_abc">
<span class="sig-prename descclassname"><span class="pre">birdepy.interface_abc.</span></span><span class="sig-name descname"><span class="pre">discrete_est_abc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sorted_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">its</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#birdepy.interface_abc.discrete_est_abc" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter estimation for discretely observed continuous-time
birth-and-death processes using approximate Bayesian computation.
See <a class="reference internal" href="estimation.html#approximate-bayesian-computation"><span class="std std-ref">here</span></a> for more information.</p>
<p>To use this function call <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> with <cite>framework</cite> set to
‘abc’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p_bounds</span><span class="p">,</span> <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="n">eps0</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">its</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                 <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gwa&#39;</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>The parameters associated with this framework (listed below) can be
accessed using kwargs in <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a>. See documentation of
<a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> for the main arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps0</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Iteration 1 maximum distance between sampled data and observed data
for a parameter sample to be included in estimate.</p></li>
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of successful parameter samples used to obtain estimate.</p></li>
<li><p><strong>its</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations of algorithm.</p></li>
<li><p><strong>method</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Simulation algorithm used to generate samples (see
<a class="reference internal" href="simulation.html#simulation-algorithms"><span class="std std-ref">here</span></a>). Should be one of:</p>
<blockquote>
<div><ul>
<li><p>’exact’</p></li>
<li><p>’ea’</p></li>
<li><p>’ma’</p></li>
<li><p>’gwa’ (default)</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>tau</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Time between samples for the approximation methods ‘ea’, ‘ma’ and ‘gwa’.
Has default value <code class="docutils literal notranslate"><span class="pre">min(min(sorted_data.keys())</span> <span class="pre">/</span> <span class="pre">10,</span> <span class="pre">0.1)</span></code> where
‘sorted_data’ is the output of utility function <code class="xref py py-func docutils literal notranslate"><span class="pre">bd.utility.data_sort2()</span></code>.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>Generator</em><em>, </em><em>optional</em>) – If <em>seed</em> is not specified the random numbers are generated according
to <em>np.random.default_rng()</em>. If <em>seed</em> is an <em>int</em>, random numbers are
generated according to <em>np.random.default_rng(seed)</em>. If seed is a
<em>Generator</em>, then that object is used. See
<a class="reference internal" href="simulation.html#reproducibility"><span class="std std-ref">here</span></a> for more information.</p></li>
<li><p><strong>distance</strong> (<em>callable</em><em>, </em><em>optional</em>) – Computes the distance between simulated data and observed data.</p></li>
<li><p><strong>stat</strong> (<em>string</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Determines whcih statistic is used to summarize the posterior distribution.</dt><dd><p>Should be one of: ‘mean’ or ‘median’.</p>
</dd>
</dl>
</p></li>
<li><p><strong>c</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of mixture components in the mixed multivariate normal which is
used as a posterior distribution when updating epsilon over iterations.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Simulate a sample path and estimate the parameters using ABC:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">birdepy</span> <span class="k">as</span> <span class="nn">bd</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">p_data</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">simulate</span><span class="o">.</span><span class="n">discrete</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">t_data</span><span class="p">,</span>
                              <span class="n">survival</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
</pre></div>
</div>
<p>Assume that the death rate and population size are known, then estimate the rate of spread:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span>
                  <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                  <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">its</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;abc estimate is&#39;</span><span class="p">,</span> <span class="n">est</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;, with standard errors&#39;</span><span class="p">,</span> <span class="n">est</span><span class="o">.</span><span class="n">se</span><span class="p">,</span>
      <span class="s1">&#39;computed in &#39;</span><span class="p">,</span> <span class="n">est</span><span class="o">.</span><span class="n">compute_time</span><span class="p">,</span> <span class="s1">&#39;seconds.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">abc</span> <span class="n">estimate</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.7445234348233319</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[[</span><span class="mf">0.06708738</span><span class="p">]]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">47.6836621761322</span> <span class="n">seconds</span><span class="o">.</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Estimation algorithms and models are also described in [1]. If you use this
function for published work, then please cite this paper.</p>
<p>For a text book treatment on the theory of birth-and-death processes
see [2].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> <a class="reference internal" href="api_probability.html#birdepy.probability" title="birdepy.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.probability()</span></code></a> <a class="reference internal" href="api_forecast.html#birdepy.forecast" title="birdepy.forecast"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.forecast()</span></code></a></p>
<p><a class="reference internal" href="api_simulate_discrete.html#birdepy.simulate.discrete" title="birdepy.simulate.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.discrete()</span></code></a> <a class="reference internal" href="api_simulate_continuous.html#birdepy.simulate.continuous" title="birdepy.simulate.continuous"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.continuous()</span></code></a></p>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets">1</span></dt>
<dd><p>Hautphenne, S. and Patch, B. BirDePy: Parameter estimation for
population-size-dependent birth-and-death processes in Python. ArXiV, 2021.</p>
</dd>
<dt class="label" id="id4"><span class="brackets">2</span></dt>
<dd><p>Feller, W. (1968) An introduction to probability theory and its
applications (Volume 1) 3rd ed. John Wiley &amp; Sons.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="birdepy-estimate-framework-dnm">
<h2>birdepy.estimate(framework=’dnm’)<a class="headerlink" href="#birdepy-estimate-framework-dnm" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="birdepy.interface_dnm.discrete_est_dnm">
<span class="sig-prename descclassname"><span class="pre">birdepy.interface_dnm.</span></span><span class="sig-name descname"><span class="pre">discrete_est_dnm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_trunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#birdepy.interface_dnm.discrete_est_dnm" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter estimation for discretely observed continuous-time
birth-and-death processes using direct numerical maximization of
approximate likelihood functions.
See <a class="reference internal" href="estimation.html#direct-numerical-maximization"><span class="std std-ref">here</span></a> for more information.</p>
<p>To use this function call <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> with <cite>framework</cite> set to
‘dnm’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p_bounds</span><span class="p">,</span> <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;dnm&#39;</span><span class="p">,</span> <span class="n">likelihood</span><span class="o">=</span><span class="s1">&#39;expm&#39;</span><span class="p">,</span> <span class="n">z_trunc</span><span class="o">=</span><span class="p">())</span>
</pre></div>
</div>
<p>The parameters associated with this framework (listed below) can be
accessed using kwargs in <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a>. See documentation of
<a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> for the main arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>likelihood</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Likelihood approximation method. Should be one of
(alphabetical ordering):</p>
<blockquote>
<div><ul>
<li><p>’da’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-da"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’Erlang’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-erlang"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’expm’  (default) (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-expm"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’gwa’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-gwa"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’gwasa’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-gwasa"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’ilt’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-ilt"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’oua’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-oua"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’uniform’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-uniform"><span class="std std-ref">here</span></a>)</p></li>
</ul>
</div></blockquote>
<p>The links point to the documentation of the relevant <cite>method</cite> in
<a class="reference internal" href="api_probability.html#birdepy.probability" title="birdepy.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.probability()</span></code></a>. The arguments associated with each of
these methods may be used as a kwarg in <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a>
when <cite>likelihood</cite> is set to use the method.</p>
</p></li>
<li><p><strong>z_trunc</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Truncation thresholds, i.e., minimum and maximum states of process
considered. Array of real elements of size (2,) by default
<code class="docutils literal notranslate"><span class="pre">z_trunc=[z_min,</span> <span class="pre">z_max]</span></code> where
<code class="docutils literal notranslate"><span class="pre">z_min=max(0,</span> <span class="pre">min(p_data)</span> <span class="pre">-</span> <span class="pre">2*z_range)</span></code>
and <code class="docutils literal notranslate"><span class="pre">z_max=max(p_data)</span> <span class="pre">+</span> <span class="pre">2*z_range</span></code> where
<code class="docutils literal notranslate"><span class="pre">z_range=max(p_data)-min(p_data)</span></code>. Only applicable to <cite>likelihood</cite>
methods ‘Erlang’, ‘expm’ and ‘uniform’.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Simulate a sample path and estimate the parameters using the various
likelihood approximation methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">birdepy</span> <span class="k">as</span> <span class="nn">bd</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">p_data</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">simulate</span><span class="o">.</span><span class="n">discrete</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">t_data</span><span class="p">,</span>
                              <span class="n">survival</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
<span class="k">for</span> <span class="n">likelihood</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;da&#39;</span><span class="p">,</span> <span class="s1">&#39;Erlang&#39;</span><span class="p">,</span> <span class="s1">&#39;expm&#39;</span><span class="p">,</span> <span class="s1">&#39;gwa&#39;</span><span class="p">,</span> <span class="s1">&#39;gwasa&#39;</span><span class="p">,</span> <span class="s1">&#39;ilt&#39;</span><span class="p">,</span> <span class="s1">&#39;oua&#39;</span><span class="p">,</span> <span class="s1">&#39;uniform&#39;</span><span class="p">]:</span>
    <span class="n">likelihood</span> <span class="o">=</span> <span class="s1">&#39;gwasa&#39;</span>
    <span class="n">est</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mf">1e-6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
                     <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;dnm&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                      <span class="n">likelihood</span><span class="o">=</span><span class="n">likelihood</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dnm estimate using&#39;</span><span class="p">,</span> <span class="n">likelihood</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="n">est</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;, with standard errors&#39;</span><span class="p">,</span>
          <span class="n">est</span><span class="o">.</span><span class="n">se</span><span class="p">,</span> <span class="s1">&#39;computed in &#39;</span><span class="p">,</span> <span class="n">est</span><span class="o">.</span><span class="n">compute_time</span><span class="p">,</span> <span class="s1">&#39;seconds.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dnm</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">da</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.742967758293063</span><span class="p">,</span> <span class="mf">0.21582082476775125</span><span class="p">,</span> <span class="mf">0.022598554340938885</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[</span><span class="mf">0.16633436</span> <span class="mf">0.03430501</span> <span class="mf">0.00436483</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">12.29400086402893</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">dnm</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">Erlang</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.7478158070214841</span><span class="p">,</span> <span class="mf">0.2150341741826537</span><span class="p">,</span> <span class="mf">0.022748822721356705</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[</span><span class="mf">0.16991822</span> <span class="mf">0.0345762</span>  <span class="mf">0.00435054</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">0.9690003395080566</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">dnm</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">expm</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.7477255598292176</span><span class="p">,</span> <span class="mf">0.2150476994316206</span><span class="p">,</span> <span class="mf">0.022745305129350565</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[</span><span class="mf">0.16904095</span> <span class="mf">0.03443197</span> <span class="mf">0.00433563</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">1.6919987201690674</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">dnm</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">gwa</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.6600230500097711</span><span class="p">,</span> <span class="mf">0.16728663936008945</span><span class="p">,</span> <span class="mf">0.02512248420514078</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[</span><span class="mf">0.14248815</span> <span class="mf">0.02447161</span> <span class="mf">0.00488879</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">37.52255415916443</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">dnm</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">gwasa</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.6604981297820195</span><span class="p">,</span> <span class="mf">0.16924607541398484</span><span class="p">,</span> <span class="mf">0.02492054535741541</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[</span><span class="mf">0.14244908</span> <span class="mf">0.02485465</span> <span class="mf">0.00488222</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">0.8699958324432373</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">dnm</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">ilt</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.7466254648849691</span><span class="p">,</span> <span class="mf">0.21415145383850764</span><span class="p">,</span> <span class="mf">0.022794996238547492</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[</span><span class="mf">0.10187377</span> <span class="mf">0.03137803</span>        <span class="n">nan</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">1185.0924031734467</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">dnm</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">oua</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.5000083585920406</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[</span>       <span class="n">nan</span>        <span class="n">nan</span> <span class="mf">0.01961143</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">3.466001272201538</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">dnm</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">uniform</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.7477293759434092</span><span class="p">,</span> <span class="mf">0.215047068344254</span><span class="p">,</span> <span class="mf">0.022745437226772615</span><span class="p">]</span> <span class="p">,</span> <span class="k">with</span> <span class="n">standard</span> <span class="n">errors</span> <span class="p">[</span><span class="mf">0.16900378</span> <span class="mf">0.03443071</span> <span class="mf">0.00433504</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">3.275972366333008</span> <span class="n">seconds</span><span class="o">.</span>
</pre></div>
</div>
<p>The constraint <code class="docutils literal notranslate"><span class="pre">con={'type':</span> <span class="pre">'ineq',</span> <span class="pre">'fun':</span> <span class="pre">lambda</span> <span class="pre">p:</span> <span class="pre">p[0]-p[1]}</span></code> ensures
that p[0] &gt; p[1] (i.e., rate of spread greater than recovery rate).</p>
<p>How well methods perform varies from case to case. In this instance most methods perform well,
while some throw errors but return useful output regardless, and some fail altogether.</p>
<p class="rubric">Notes</p>
<p>Estimation algorithms and models are also described in [1]. If you use this
function for published work, then please cite this paper.</p>
<p>For a text book treatment on the theory of birth-and-death processes
see [2].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> <a class="reference internal" href="api_probability.html#birdepy.probability" title="birdepy.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.probability()</span></code></a> <a class="reference internal" href="api_forecast.html#birdepy.forecast" title="birdepy.forecast"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.forecast()</span></code></a></p>
<p><a class="reference internal" href="api_simulate_discrete.html#birdepy.simulate.discrete" title="birdepy.simulate.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.discrete()</span></code></a> <a class="reference internal" href="api_simulate_continuous.html#birdepy.simulate.continuous" title="birdepy.simulate.continuous"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.continuous()</span></code></a></p>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets">1</span></dt>
<dd><p>Hautphenne, S. and Patch, B. BirDePy: Parameter estimation for
population-size-dependent birth-and-death processes in Python. ArXiV, 2021.</p>
</dd>
<dt class="label" id="id6"><span class="brackets">2</span></dt>
<dd><p>Feller, W. (1968) An introduction to probability theory and its
applications (Volume 1) 3rd ed. John Wiley &amp; Sons.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="birdepy-estimate-framework-em">
<h2>birdepy.estimate(framework=’em’)<a class="headerlink" href="#birdepy-estimate-framework-em" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="birdepy.interface_em.discrete_est_em">
<span class="sig-prename descclassname"><span class="pre">birdepy.interface_em.</span></span><span class="sig-name descname"><span class="pre">discrete_est_em</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">technique</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accelerator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">likelihood</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_trunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_it</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">display</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#birdepy.interface_em.discrete_est_em" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter estimation for discretely observed continuous-time
birth-and-death processes using the expectation maximization algorithm.
See <a class="reference internal" href="estimation.html#expectation-maximization"><span class="std std-ref">here</span></a> for more information.</p>
<p>To use this function call <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> with <cite>framework</cite> set to
‘em’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p_bounds</span><span class="p">,</span> <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="n">technique</span><span class="o">=</span><span class="s1">&#39;expm&#39;</span><span class="p">,</span>
                 <span class="n">accelerator</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">likelihood</span><span class="o">=</span><span class="s1">&#39;expm&#39;</span><span class="p">,</span> <span class="n">laplace_method</span><span class="o">=</span><span class="s1">&#39;cme-talbot&#39;</span><span class="p">,</span>
                 <span class="n">lentz_eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">max_it</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">i_tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">j_tol</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">h_tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span>
                 <span class="n">z_trunc</span><span class="o">=</span><span class="p">())</span>
</pre></div>
</div>
<p>The parameters associated with this framework (listed below) can be
accessed using kwargs in <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a>. See documentation of
<a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> for the main arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>technique</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Expectation step technique. Should be one of
(alphabetical ordering):</p>
<blockquote>
<div><ul>
<li><p>’expm’ (default)</p></li>
<li><p>’ilt’</p></li>
<li><p>’num’</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="estimation.html#expectation-step-techniques"><span class="std std-ref">here</span></a> for more information.</p>
</p></li>
<li><p><strong>accelerator</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>EM accelerator method. Should be one of
(alphabetical ordering):</p>
<blockquote>
<div><ul>
<li><p>’cg’ (see [3])</p></li>
<li><p>’none’ (see [4])</p></li>
<li><p>’Lange’ (default) (see [5])</p></li>
<li><p>’qn1’ (see [6])</p></li>
<li><p>’qn2’ (see [6])</p></li>
</ul>
</div></blockquote>
<p>See <a class="reference internal" href="estimation.html#acceleration"><span class="std std-ref">here</span></a> for more information.</p>
</p></li>
<li><p><strong>likelihood</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Likelihood approximation method. Should be one of
(alphabetical ordering):</p>
<blockquote>
<div><ul>
<li><p>’da’ (default) (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-da"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’Erlang’ (default) (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-erlang"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’expm’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-expm"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’gwa’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-gwa"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’gwasa’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-gwasa"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’ilt’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-ilt"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’oua’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-oua"><span class="std std-ref">here</span></a>)</p></li>
<li><p>’uniform’ (see <a class="reference internal" href="api_probability.html#birdepy-probability-method-uniform"><span class="std std-ref">here</span></a>)</p></li>
</ul>
</div></blockquote>
<p>The links point to the documentation of the relevant <cite>method</cite> in
<a class="reference internal" href="api_probability.html#birdepy.probability" title="birdepy.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.probability()</span></code></a>. The arguments associated with each of
these methods may be used as a kwarg in <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a>
when <cite>likelihood</cite> is set to use the method.</p>
</p></li>
<li><p><strong>laplace_method</strong> (<em>string</em><em>, </em><em>optional</em>) – Numerical inverse Laplace transform algorithm to use. Should be one of:
‘cme-talbot’ (default), ‘cme’, ‘euler’, ‘gaver’, ‘talbot’, ‘stehfest’,
‘dehoog’, ‘cme-mp’ or ‘gwr’.</p></li>
<li><p><strong>lentz_eps</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Termination threshold for Lentz algorithm computation of Laplace
domain functions.</p></li>
<li><p><strong>max_it</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations of the algorithm to perform.</p></li>
<li><p><strong>i_tol</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Algorithm terminates when <code class="docutils literal notranslate"><span class="pre">sum(abs(p(i)</span> <span class="pre">-</span> <span class="pre">p(i-1))</span> <span class="pre">&lt;</span> <span class="pre">i_tol</span></code>
where <cite>p(i)</cite> and <cite>p(i-1)</cite> are estimates corresponding to iteration <cite>i</cite>
and <cite>i-1</cite>.</p></li>
<li><p><strong>j_tol</strong> (<em>scalar</em><em>, </em><em>optional</em>) – States with expected number of upward transitions or expected number
of downward transitions greater than <cite>j_tol</cite> are included in E steps.</p></li>
<li><p><strong>h_tol</strong> (<em>scalar</em><em>, </em><em>optional</em>) – States with expected holding time greater than <cite>h_tol</cite> are included in
E steps.</p></li>
<li><p><strong>z_trunc</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Truncation thresholds, i.e., minimum and maximum states of process
considered. Array of real elements of size (2,) by default
<code class="docutils literal notranslate"><span class="pre">z_trunc=[z_min,</span> <span class="pre">z_max]</span></code> where
<code class="docutils literal notranslate"><span class="pre">z_min=max(0,</span> <span class="pre">min(p_data)</span> <span class="pre">-</span> <span class="pre">2*z_range)</span></code>
and <code class="docutils literal notranslate"><span class="pre">z_max=max(p_data)</span> <span class="pre">+</span> <span class="pre">2*z_range</span></code> where
<code class="docutils literal notranslate"><span class="pre">z_range=max(p_data)-min(p_data)</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Use <a class="reference internal" href="api_simulate_discrete.html#birdepy.simulate.discrete" title="birdepy.simulate.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.discrete()</span></code></a> to simulate a sample path of the ‘Verhulst 2 (SIS)’
model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">birdepy</span> <span class="k">as</span> <span class="nn">bd</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">p_data</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">simulate</span><span class="o">.</span><span class="n">discrete</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">t_data</span><span class="p">,</span>
                              <span class="n">survival</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
</pre></div>
</div>
<p>Estimate the parameter values from the simulated data using the ‘em’
<cite>framework</cite> with various <cite>technique</cite> and <cite>accelerator</cite> approaches:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">technique</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;expm&#39;</span><span class="p">,</span> <span class="s1">&#39;ilt&#39;</span><span class="p">,</span> <span class="s1">&#39;num&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">accelerator</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;cg&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;Lange&#39;</span><span class="p">,</span> <span class="s1">&#39;qn1&#39;</span><span class="p">,</span> <span class="s1">&#39;qn2&#39;</span><span class="p">]:</span>
        <span class="n">tic</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">est</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mf">1e-6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
                          <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;em&#39;</span><span class="p">,</span> <span class="n">technique</span><span class="o">=</span><span class="n">technique</span><span class="p">,</span> <span class="n">accelerator</span><span class="o">=</span><span class="n">accelerator</span><span class="p">,</span>
                          <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>The constraint <code class="docutils literal notranslate"><span class="pre">con={'type':</span> <span class="pre">'ineq',</span> <span class="pre">'fun':</span> <span class="pre">lambda</span> <span class="pre">p:</span> <span class="pre">p[0]-p[1]}</span></code> ensures
that p[0] &gt; p[1] (i.e., rate of spread greater than recovery rate).</p>
<p>A <code class="docutils literal notranslate"><span class="pre">RuntimeWarning</span></code> associated with SciPy’s <code class="xref py py-func docutils literal notranslate"><span class="pre">minimize()</span></code> function  may
appear, this can be ignored.</p>
<p class="rubric">Notes</p>
<p>Estimation algorithms and models are also described in [1]. If you use this
function for published work, then please cite this paper.</p>
<p>For a text book treatment on the theory of birth-and-death processes
see [2].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> <a class="reference internal" href="api_probability.html#birdepy.probability" title="birdepy.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.probability()</span></code></a> <a class="reference internal" href="api_forecast.html#birdepy.forecast" title="birdepy.forecast"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.forecast()</span></code></a></p>
<p><a class="reference internal" href="api_simulate_discrete.html#birdepy.simulate.discrete" title="birdepy.simulate.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.discrete()</span></code></a> <a class="reference internal" href="api_simulate_continuous.html#birdepy.simulate.continuous" title="birdepy.simulate.continuous"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.continuous()</span></code></a></p>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets">1</span></dt>
<dd><p>Hautphenne, S. and Patch, B. BirDePy: Parameter estimation for
population-size-dependent birth-and-death processes in Python. ArXiV, 2021.</p>
</dd>
<dt class="label" id="id8"><span class="brackets">2</span></dt>
<dd><p>Feller, W. (1968) An introduction to probability theory and its
applications (Volume 1) 3rd ed. John Wiley &amp; Sons.</p>
</dd>
<dt class="label" id="id9"><span class="brackets">3</span></dt>
<dd><p>Jamshidian, M. and  Jennrich, R.I. Conjugate gradient acceleration
of the EM algorithm. Journal of the American Statistical Association,
88(421):221-228, 1993.</p>
</dd>
<dt class="label" id="id10"><span class="brackets">4</span></dt>
<dd><p>Dempster, A.P., Laird, N.M. and Rubin, D.B. Maximum likelihood from
incomplete data via the EM algorithm. Journal of the Royal Statistical
Society: Series B (Methodological), 39(1):1-22, 1977.</p>
</dd>
<dt class="label" id="id11"><span class="brackets">5</span></dt>
<dd><p>Lange, K. A quasi-Newton acceleration of the EM algorithm.
Statistica Sinica, 1-18, 1995.</p>
</dd>
<dt class="label" id="id12"><span class="brackets">6</span></dt>
<dd><p>Jamshidian, M. and  Jennrich, R.I. Acceleration of the EM algorithm
by using quasi-Newton methods. Journal of the Royal Statistical
Society: Series B (Methodological), 59(3):569-587, 1997.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="birdepy-estimate-framework-lse">
<h2>birdepy.estimate(framework=’lse’)<a class="headerlink" href="#birdepy-estimate-framework-lse" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="birdepy.interface_lse.discrete_est_lse">
<span class="sig-prename descclassname"><span class="pre">birdepy.interface_lse.</span></span><span class="sig-name descname"><span class="pre">discrete_est_lse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squares</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_trunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#birdepy.interface_lse.discrete_est_lse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter estimation for discretely observed continuous-time
birth-and-death processes using least squares estimation.
See <a class="reference internal" href="estimation.html#least-squares-estimation"><span class="std std-ref">here</span></a> for more information.</p>
<p>To use this function call <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> with <cite>framework</cite> set to
‘lse’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p_bounds</span><span class="p">,</span> <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;lse&#39;</span><span class="p">,</span> <span class="n">squares</span><span class="o">=</span><span class="s1">&#39;fm&#39;</span><span class="p">,</span> <span class="n">z_trunc</span><span class="o">=</span><span class="p">())</span>
</pre></div>
</div>
<p>The parameters associated with this framework (listed below) can be
accessed using kwargs in <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a>. See documentation of
<a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> for the main arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>squares</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Squared error from the expected value approximation method. Should be
one of (alphabetical ordering):</p>
<blockquote>
<div><ul>
<li><p>’expm’</p></li>
<li><p>’fm’ (default)</p></li>
<li><p>’gwa’</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>z_trunc</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Truncation thresholds, i.e., minimum and maximum states of process
considered. Array of real elements of size (2,) by default
<code class="docutils literal notranslate"><span class="pre">z_trunc=[z_min,</span> <span class="pre">z_max]</span></code> where
<code class="docutils literal notranslate"><span class="pre">z_min=max(0,</span> <span class="pre">min(p_data)</span> <span class="pre">-</span> <span class="pre">2*z_range)</span></code>
and <code class="docutils literal notranslate"><span class="pre">z_max=max(p_data)</span> <span class="pre">+</span> <span class="pre">2*z_range</span></code> where
<code class="docutils literal notranslate"><span class="pre">z_range=max(p_data)-min(p_data)</span></code>. Only applicable to <cite>squares</cite>
method ‘expm’.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Simulate a sample path and estimate the parameters using the various
likelihood approximation methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">birdepy</span> <span class="k">as</span> <span class="nn">bd</span>
<span class="n">t_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">p_data</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">simulate</span><span class="o">.</span><span class="n">discrete</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">t_data</span><span class="p">,</span>
                              <span class="n">survival</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
<span class="k">for</span> <span class="n">squares</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;expm&#39;</span><span class="p">,</span> <span class="s1">&#39;fm&#39;</span><span class="p">,</span> <span class="s1">&#39;gwa&#39;</span><span class="p">]:</span>
    <span class="n">est</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mf">1e-6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">1e-6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
                      <span class="n">framework</span><span class="o">=</span><span class="s1">&#39;lse&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                      <span class="n">squares</span><span class="o">=</span><span class="n">squares</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;lse estimate using&#39;</span><span class="p">,</span> <span class="n">squares</span><span class="p">,</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span> <span class="n">est</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;computed in &#39;</span><span class="p">,</span> <span class="n">est</span><span class="o">.</span><span class="n">compute_time</span><span class="p">,</span> <span class="s1">&#39;seconds.&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lse</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">expm</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.7879591925854611</span><span class="p">,</span> <span class="mf">0.26289368236374644</span><span class="p">,</span> <span class="mf">0.02000871498805996</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">1.2579967975616455</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">lse</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">fm</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.7941603523732229</span><span class="p">,</span> <span class="mf">0.2766621569715867</span><span class="p">,</span> <span class="mf">0.019363240909074483</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">5.483000755310059</span> <span class="n">seconds</span><span class="o">.</span>
<span class="n">lse</span> <span class="n">estimate</span> <span class="n">using</span> <span class="n">gwa</span> <span class="ow">is</span> <span class="p">[</span><span class="mf">0.7024952317382023</span><span class="p">,</span> <span class="mf">0.20563650045779058</span><span class="p">,</span> <span class="mf">0.022598851311981704</span><span class="p">]</span> <span class="n">computed</span> <span class="ow">in</span>  <span class="mf">0.09800028800964355</span> <span class="n">seconds</span><span class="o">.</span>
</pre></div>
</div>
<p>The constraint <code class="docutils literal notranslate"><span class="pre">con={'type':</span> <span class="pre">'ineq',</span> <span class="pre">'fun':</span> <span class="pre">lambda</span> <span class="pre">p:</span> <span class="pre">p[0]-p[1]}</span></code> ensures
that p[0] &gt; p[1] (i.e., rate of spread greater than recovery rate).</p>
<p class="rubric">Notes</p>
<p>Estimation algorithms and models are also described in [1]. If you use this
function for published work, then please cite this paper.</p>
<p>For a text book treatment on the theory of birth-and-death processes
see [2].</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> <a class="reference internal" href="api_probability.html#birdepy.probability" title="birdepy.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.probability()</span></code></a> <a class="reference internal" href="api_forecast.html#birdepy.forecast" title="birdepy.forecast"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.forecast()</span></code></a></p>
<p><a class="reference internal" href="api_simulate_discrete.html#birdepy.simulate.discrete" title="birdepy.simulate.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.discrete()</span></code></a> <a class="reference internal" href="api_simulate_continuous.html#birdepy.simulate.continuous" title="birdepy.simulate.continuous"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.continuous()</span></code></a></p>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id13"><span class="brackets">1</span></dt>
<dd><p>Hautphenne, S. and Patch, B. BirDePy: Parameter estimation for
population-size-dependent birth-and-death processes in Python. ArXiV, 2021.</p>
</dd>
<dt class="label" id="id14"><span class="brackets">2</span></dt>
<dd><p>Feller, W. (1968) An introduction to probability theory and its
applications (Volume 1) 3rd ed. John Wiley &amp; Sons.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="birdepy-estimate-scheme-continuous">
<h2>birdepy.estimate(scheme=’continuous’)<a class="headerlink" href="#birdepy-estimate-scheme-continuous" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="birdepy.interface_dnm.continuous_est_dnm">
<span class="sig-prename descclassname"><span class="pre">birdepy.interface_dnm.</span></span><span class="sig-name descname"><span class="pre">continuous_est_dnm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_known_p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#birdepy.interface_dnm.continuous_est_dnm" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter estimation for continuously  observed continuous-time
birth-and-death processes using direct numerical maximization of
the likelihood.
See <a class="reference internal" href="estimation.html#continuously-observed-data"><span class="std std-ref">here</span></a> for more information.</p>
<p>To use this function call <a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> with <cite>scheme</cite> set to
‘continuous’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">p_bounds</span><span class="p">,</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;continuous&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<p>Simulate a continuous sample path and estimate the parameters.</p>
<p>Import BirDePy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">birdepy</span> <span class="k">as</span> <span class="nn">bd</span>
</pre></div>
</div>
<p>Simulate some synthetic data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">simulate</span><span class="o">.</span><span class="n">continuous</span><span class="p">([</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
                                        <span class="mi">100</span><span class="p">,</span> <span class="n">survival</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2021</span><span class="p">)</span>
</pre></div>
</div>
<p>Estimate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">est</span> <span class="o">=</span> <span class="n">bd</span><span class="o">.</span><span class="n">estimate</span><span class="p">(</span><span class="n">t_data</span><span class="p">,</span> <span class="n">p_data</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
                  <span class="n">model</span><span class="o">=</span><span class="s1">&#39;Ricker&#39;</span><span class="p">,</span> <span class="n">idx_known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">known_p</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">scheme</span><span class="o">=</span><span class="s1">&#39;continuous&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">est</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>Outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">0.7603171062895576</span><span class="p">,</span> <span class="mf">0.2514810854871476</span><span class="p">,</span> <span class="mf">0.020294342655751033</span><span class="p">]</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Estimation algorithms and models are also described in [1]. If you use this
function for published work, then please cite this paper.</p>
<p>For a text book treatment on the theory of birth-and-death processes
see [2].</p>
<p>See also
<a class="reference internal" href="#birdepy.estimate" title="birdepy.estimate"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.estimate()</span></code></a> <a class="reference internal" href="api_probability.html#birdepy.probability" title="birdepy.probability"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.probability()</span></code></a> <a class="reference internal" href="api_forecast.html#birdepy.forecast" title="birdepy.forecast"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.forecast()</span></code></a></p>
<p><a class="reference internal" href="api_simulate_discrete.html#birdepy.simulate.discrete" title="birdepy.simulate.discrete"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.discrete()</span></code></a> <a class="reference internal" href="api_simulate_continuous.html#birdepy.simulate.continuous" title="birdepy.simulate.continuous"><code class="xref py py-func docutils literal notranslate"><span class="pre">birdepy.simulate.continuous()</span></code></a></p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id15"><span class="brackets">1</span></dt>
<dd><p>Hautphenne, S. and Patch, B. BirDePy: Parameter estimation for
population-size-dependent birth-and-death processes in Python. ArXiV, 2021.</p>
</dd>
<dt class="label" id="id16"><span class="brackets">2</span></dt>
<dd><p>Feller, W. (1968) An introduction to probability theory and its
applications (Volume 1) 3rd ed. John Wiley &amp; Sons.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api_simulate_discrete.html" class="btn btn-neutral float-right" title="birdepy.simulate.discrete()" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="api_probability.html" class="btn btn-neutral float-left" title="birdepy.probability()" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Sophie Hautphenne and Brendan Patch.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>